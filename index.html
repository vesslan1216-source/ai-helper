<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¶è£…çŸ­è§†é¢‘çˆ†æ¬¾ç¥å™¨ - ç»™æ’æ°´ä¸“å®¶ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-slate-50 min-h-screen">
    <div class="max-w-md mx-auto bg-white min-h-screen shadow-lg flex flex-col">
        <header class="bg-blue-600 p-6 text-white text-center">
            <h1 class="text-2xl font-bold">å®¶è£… IP çˆ†æ¬¾åŠ©æ‰‹</h1>
            <p class="text-blue-100 mt-2">ç»™æ’æ°´ä¸“ä¸šç‰ˆ Â· AI é©±åŠ¨è¿›åŒ–ä¸­</p>
        </header>

        <main class="p-4 flex-grow">
            <div class="bg-blue-50 p-4 rounded-xl mb-6">
                <label class="block text-blue-800 font-bold mb-2">
                    <i class="fas fa-hammer mr-2"></i>å·¥åœ°ç°çŠ¶æè¿°
                </label>
                <textarea id="userInput" rows="5" 
                    class="w-full p-4 rounded-lg border-2 border-blue-200 focus:border-blue-500 focus:outline-none text-gray-700"
                    placeholder="ä¾‹å¦‚ï¼šä»Šå¤©åœ¨å·¥åœ°å‘ç°å·¥äººæ°´ç®¡äº¤å‰æ²¡ç”¨è¿‡æ¡¥å¼¯ï¼Œè¿™æ ·ä¼šå¯¼è‡´åæœŸæ‰¾å¹³è¿‡åš..."></textarea>
                
                <div class="mt-4">
                    <label class="block text-blue-800 font-bold mb-2">ğŸ”‘ æˆæƒç </label>
                    <input type="password" id="userCode" class="w-full p-2 rounded border border-blue-200" placeholder="è¾“å…¥æ‚¨çš„ 699 ä¸“å±æˆæƒç ">
                </div>

                <button onclick="generateScript()" id="genBtn"
                    class="w-full mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl transition-all transform active:scale-95 shadow-lg">
                    <span>ç”Ÿæˆçˆ†æ¬¾è„šæœ¬</span> <i class="fas fa-magic ml-2"></i>
                </button>
            </div>

            <div id="resultArea" class="hidden space-y-4">
                <div class="border-l-4 border-green-500 bg-green-50 p-4 rounded-r-xl">
                    <h3 class="font-bold text-green-800 mb-2">âœ¨ AI å·²ç”Ÿæˆè„šæœ¬ï¼š</h3>
                    <div id="scriptContent" class="text-gray-700 leading-relaxed whitespace-pre-wrap text-sm"></div>
                </div>
                <button onclick="copyText()" class="w-full py-3 border-2 border-blue-600 text-blue-600 rounded-xl font-bold">
                    ä¸€é”®å¤åˆ¶å†…å®¹
                </button>
            </div>
        </main>
    </div>

    <script>
        async function generateScript() {
            const prompt = document.getElementById('userInput').value;
            const userCode = document.getElementById('userCode').value;
            const btn = document.getElementById('genBtn');
            const resultArea = document.getElementById('resultArea');

            if (!prompt || !userCode) { alert('è¯·å¡«å†™å·¥åœ°æè¿°å’Œæˆæƒç ï¼'); return; }

            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> æ­£åœ¨è¿æ¥æœ€å¼ºå¤§è„‘...';

            try {
                const response = await fetch('/api/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt, userCode })
                });
                const data = await response.json();
                if (data.error) throw new Error(data.error);

                document.getElementById('scriptContent').innerText = data.text;
                resultArea.classList.remove('hidden');
            } catch (err) {
                alert(err.message);
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'é‡æ–°ç”Ÿæˆ <i class="fas fa-magic ml-2"></i>';
            }
        }

        function copyText() {
            const text = document.getElementById('scriptContent').innerText;
            navigator.clipboard.writeText(text).then(() => alert('è„šæœ¬å·²æˆåŠŸå¤åˆ¶ï¼'));
        }
    </script>
</body>
</html>